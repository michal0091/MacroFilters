% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_algo_mbh.R
\name{mbh_filter}
\alias{mbh_filter}
\title{MacroBoost Hybrid (MBH) Filter}
\usage{
mbh_filter(x, knots = NULL, mstop = 500L, d = NULL, nu = 0.2)
}
\arguments{
\item{x}{Numeric vector, \code{ts}, \code{xts}, or \code{zoo} object.}

\item{knots}{Integer.
Number of interior knots for the P-Spline.
If \code{NULL} (default), it is calculated as \code{max(20, floor(n / 2))}.
High knot density is required for the trend to be flexible enough.}

\item{mstop}{Integer.
Number of boosting iterations (default 500).
Robust loss functions require more iterations to converge than L2 loss.}

\item{d}{Numeric or \code{NULL}.
The delta parameter for Huber loss. If \code{NULL} (default), it is
auto-calibrated as the Median Absolute Deviation (MAD) of the first
differences of the series. This makes the threshold robust and
scale-invariant, working correctly for both log-differenced and level
series. Supply an explicit numeric value to override this behaviour.}

\item{nu}{Numeric.
The learning rate (shrinkage) for boosting (default 0.2).}
}
\value{
A \code{macrofilter} object with \code{trend}, \code{cycle}, \code{data}, and \code{meta}
components.  The \code{meta} list contains \code{method = "MBH"}, \code{knots}, \code{d},
\code{mstop}, \code{nu}, and \code{compute_time}.
}
\description{
Decomposes a time series into trend and cycle using a robust boosting
algorithm. Unlike the HP filter, MBH uses the Huber loss function to
automatically downweight outliers (like the COVID-19 shock), preventing
them from distorting the trend.
}
\details{
The model estimated is an additive model:
\deqn{y_t = \text{Linear}(t) + \text{Smooth}(t) + \epsilon_t}

It is fitted using \code{\link[mboost:gamboost]{mboost::mboost()}} with:
\itemize{
\item \strong{Base Learners:} A linear time trend (\code{\link[mboost:baselearners]{mboost::bols()}}) to capture
the global path, plus a B-spline (\code{\link[mboost:baselearners]{mboost::bbs()}}) to capture local
curvature.
\item \strong{Loss Function:} Huber loss (\code{\link[mboost:Family]{mboost::Huber()}}) with parameter
\code{d}.  This is the key to robustness.
}

The default parameters (\code{knots = n/2}, \code{mstop = 500}) are calibrated to
mimic the flexibility of a standard HP filter while retaining the robustness
of the Huber loss.
}
\examples{
# Quarterly GDP-like series
set.seed(42)
y <- ts(cumsum(rnorm(200)), start = c(2000, 1), frequency = 4)
result <- mbh_filter(y)
print(result)
}
