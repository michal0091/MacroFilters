<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Boosted HP Filter — bhp_filter • MacroFilters</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Boosted HP Filter — bhp_filter"><meta name="description" content="Iteratively applies the Hodrick-Prescott filter on residuals to better
capture stochastic trends.  At each iteration the HP smoother is applied to
the current residual and the resulting trend increment is added to the
cumulative trend estimate.  Iteration stops according to one of three rules:
BIC minimisation (default), ADF stationarity test on residuals, or a fixed
number of iterations."><meta property="og:description" content="Iteratively applies the Hodrick-Prescott filter on residuals to better
capture stochastic trends.  At each iteration the HP smoother is applied to
the current residual and the resulting trend increment is added to the
cumulative trend estimate.  Iteration stops according to one of three rules:
BIC minimisation (default), ADF stationarity test on residuals, or a fixed
number of iterations."><meta property="og:image" content="https://michal0091.github.io/MacroFilters/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MacroFilters</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to MacroFilters</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michal0091/MacroFilters/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Boosted HP Filter</h1>
      <small class="dont-index">Source: <a href="https://github.com/michal0091/MacroFilters/blob/main/R/04_algo_bhp.R" class="external-link"><code>R/04_algo_bhp.R</code></a></small>
      <div class="d-none name"><code>bhp_filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Iteratively applies the Hodrick-Prescott filter on residuals to better
capture stochastic trends.  At each iteration the HP smoother is applied to
the current residual and the resulting trend increment is added to the
cumulative trend estimate.  Iteration stops according to one of three rules:
BIC minimisation (default), ADF stationarity test on residuals, or a fixed
number of iterations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bhp_filter</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  stopping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span>, <span class="st">"adf"</span>, <span class="st">"fixed"</span><span class="op">)</span>,</span>
<span>  sig_level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  freq <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector, <code>ts</code>, <code>xts</code>, or <code>zoo</code> object.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Smoothing parameter.
If <code>NULL</code> (default), it is auto-detected using the Ravn-Uhlig rule
(<code>6.25 * freq^4</code>).</p></dd>


<dt id="arg-iter-max">iter_max<a class="anchor" aria-label="anchor" href="#arg-iter-max"></a></dt>
<dd><p>Integer.
Maximum number of boosting iterations (default 100).</p></dd>


<dt id="arg-stopping">stopping<a class="anchor" aria-label="anchor" href="#arg-stopping"></a></dt>
<dd><p>Character.
Stopping rule: <code>"bic"</code> (default), <code>"adf"</code>, or <code>"fixed"</code>.</p></dd>


<dt id="arg-sig-level">sig_level<a class="anchor" aria-label="anchor" href="#arg-sig-level"></a></dt>
<dd><p>Numeric.
Significance level for the ADF test when <code>stopping = "adf"</code>
(default 0.05).</p></dd>


<dt id="arg-freq">freq<a class="anchor" aria-label="anchor" href="#arg-freq"></a></dt>
<dd><p>Numeric frequency override (1 = annual, 4 = quarterly,
12 = monthly). Used only when <code>lambda</code> is <code>NULL</code> and the frequency cannot
be inferred from <code>x</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>macrofilter</code> object with <code>trend</code>, <code>cycle</code>, <code>data</code>, and <code>meta</code>
components.  The <code>meta</code> list contains <code>method = "bHP"</code>, <code>lambda</code>,
<code>iterations</code>, <code>stopping_rule</code>, and <code>compute_time</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The boosted HP filter starts from the standard HP solution and then
re-applies the same HP smoother to the residual (cycle) component.  The
trend increment from each pass is accumulated, and the procedure stops
when one of the following criteria is met:</p>
<dl><dt><code>"bic"</code></dt>
<dd><p>Schwarz information criterion computed as
\(n \log(\hat\sigma^2) + \log(n)\,\mathrm{tr}(S^m)\),
where \(S^m\) is the iterated smoother.  Iteration stops when the BIC
increases relative to the previous best.</p></dd>

<dt><code>"adf"</code></dt>
<dd><p>Augmented Dickey-Fuller test on the residual.  Iteration
stops when the residual is stationary at level <code>sig_level</code>.</p></dd>

<dt><code>"fixed"</code></dt>
<dd><p>Runs exactly <code>iter_max</code> iterations.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Phillips, P.C.B. and Shi, Z. (2021). Boosting: Why You Can Use the HP
Filter. <em>International Economic Review</em>, 62(2), 521–570.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Quarterly GDP-like series</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">bhp_filter</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- MacroFilter [bHP] --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observations : 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters   : lambda = 1600, iterations = 93, stopping_rule = bic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Cycle range  : [-1.728, 1.688]  sd = 0.6928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Compute time : 0.018 s</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michal Kinel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

